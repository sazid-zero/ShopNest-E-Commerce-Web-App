{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///E:/Frontend%20Projects/E-Commerce/src/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nconst pool = new Pool({\r\n  connectionString: process.env.DATABASE_URL,\r\n  ssl: {\r\n    rejectUnauthorized: false\r\n  }\r\n});\r\n\r\nexport default pool;\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,qJAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK;QACH,oBAAoB;IACtB;AACF;uCAEe"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///E:/Frontend%20Projects/E-Commerce/src/app/api/products/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport pool from \"@/lib/db\";\r\nimport { verifyAndSyncUser } from \"@/lib/auth\";\r\n\r\nexport async function GET(req: NextRequest, { params }: { params: { id: string } }) {\r\n\r\n  const { id } = await params;\r\n\r\n  try {\r\n    const client = await pool.connect();\r\n    try {\r\n      const result = await client.query(`\r\n        SELECT p.*, c.name as category_name, s.name as shop_name\r\n        FROM products p\r\n        LEFT JOIN categories c ON p.category_id = c.id\r\n        LEFT JOIN shops s ON p.shop_id = s.id\r\n        WHERE p.id = $1\r\n      `, [id]);\r\n\r\n      if (result.rows.length === 0) {\r\n        return NextResponse.json({ error: \"Product not found\" }, { status: 404 });\r\n      }\r\n\r\n      const row = result.rows[0];\r\n      const product = {\r\n        id: row.id,\r\n        image: row.image_url,\r\n        title: row.name,\r\n        price: parseFloat(row.price),\r\n        original: row.original_price ? parseFloat(row.original_price) : undefined,\r\n        discount: row.discount,\r\n        rating: parseFloat(row.rating),\r\n        reviews: row.reviews_count,\r\n        type: row.type,\r\n        category: row.category_name,\r\n        description: row.description,\r\n        shopName: row.shop_name\r\n      };\r\n\r\n      return NextResponse.json(product);\r\n    } finally {\r\n      client.release();\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error fetching product:\", error);\r\n    return NextResponse.json({ error: \"Internal Server Error\" }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function DELETE(req: NextRequest, { params }: { params: { id: string } }) {\r\n  const { id } = await params;\r\n  try {\r\n    const client = await pool.connect();\r\n    try {\r\n      await client.query(\"DELETE FROM products WHERE id = $1\", [id]);\r\n      return NextResponse.json({ success: true });\r\n    } finally {\r\n      client.release();\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error deleting product:\", error);\r\n    return NextResponse.json({ error: \"Internal Server Error\" }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function PATCH(req: NextRequest, { params }: { params: { id: string } }) {\r\n  const { id } = await params;\r\n  const body = await req.json();\r\n  const { name, price, stock, description, category_id, type } = body;\r\n\r\n  try {\r\n    const client = await pool.connect();\r\n    try {\r\n      const res = await client.query(\r\n        `UPDATE products \r\n         SET name = COALESCE($1, name), \r\n             price = COALESCE($2, price), \r\n             stock = COALESCE($3, stock), \r\n             description = COALESCE($4, description),\r\n             category_id = COALESCE($5, category_id),\r\n             type = COALESCE($6, type)\r\n         WHERE id = $7 RETURNING *`,\r\n        [name, price, stock, description, category_id, type, id]\r\n      );\r\n      return NextResponse.json(res.rows[0]);\r\n    } finally {\r\n      client.release();\r\n    }\r\n  } catch (error: any) {\r\n    if (error.code === '23505') {\r\n      return NextResponse.json({ error: \"A product with this name already exists\" }, { status: 400 });\r\n    }\r\n    console.error(\"Error updating product:\", error);\r\n    return NextResponse.json({ error: \"Internal Server Error\" }, { status: 500 });\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;;;;;AAGO,eAAe,IAAI,GAAgB,EAAE,EAAE,MAAM,EAA8B;IAEhF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IAErB,IAAI;QACF,MAAM,SAAS,MAAM,6HAAI,CAAC,OAAO;QACjC,IAAI;YACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,CAAC;;;;;;MAMnC,CAAC,EAAE;gBAAC;aAAG;YAEP,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,GAAG;gBAC5B,OAAO,gJAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAoB,GAAG;oBAAE,QAAQ;gBAAI;YACzE;YAEA,MAAM,MAAM,OAAO,IAAI,CAAC,EAAE;YAC1B,MAAM,UAAU;gBACd,IAAI,IAAI,EAAE;gBACV,OAAO,IAAI,SAAS;gBACpB,OAAO,IAAI,IAAI;gBACf,OAAO,WAAW,IAAI,KAAK;gBAC3B,UAAU,IAAI,cAAc,GAAG,WAAW,IAAI,cAAc,IAAI;gBAChE,UAAU,IAAI,QAAQ;gBACtB,QAAQ,WAAW,IAAI,MAAM;gBAC7B,SAAS,IAAI,aAAa;gBAC1B,MAAM,IAAI,IAAI;gBACd,UAAU,IAAI,aAAa;gBAC3B,aAAa,IAAI,WAAW;gBAC5B,UAAU,IAAI,SAAS;YACzB;YAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;QAC3B,SAAU;YACR,OAAO,OAAO;QAChB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF;AAEO,eAAe,OAAO,GAAgB,EAAE,EAAE,MAAM,EAA8B;IACnF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,IAAI;QACF,MAAM,SAAS,MAAM,6HAAI,CAAC,OAAO;QACjC,IAAI;YACF,MAAM,OAAO,KAAK,CAAC,sCAAsC;gBAAC;aAAG;YAC7D,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAK;QAC3C,SAAU;YACR,OAAO,OAAO;QAChB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF;AAEO,eAAe,MAAM,GAAgB,EAAE,EAAE,MAAM,EAA8B;IAClF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,WAAW,EAAE,WAAW,EAAE,IAAI,EAAE,GAAG;IAE/D,IAAI;QACF,MAAM,SAAS,MAAM,6HAAI,CAAC,OAAO;QACjC,IAAI;YACF,MAAM,MAAM,MAAM,OAAO,KAAK,CAC5B,CAAC;;;;;;;kCAOyB,CAAC,EAC3B;gBAAC;gBAAM;gBAAO;gBAAO;gBAAa;gBAAa;gBAAM;aAAG;YAE1D,OAAO,gJAAY,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,EAAE;QACtC,SAAU;YACR,OAAO,OAAO;QAChB;IACF,EAAE,OAAO,OAAY;QACnB,IAAI,MAAM,IAAI,KAAK,SAAS;YAC1B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0C,GAAG;gBAAE,QAAQ;YAAI;QAC/F;QACA,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}